{% extends "base.html" %}

{% block content %}
<input class="form-control" type="text" placeholder="Search..." id="search" onkeyup='tableSearch("search", "table")'>
<table id="table" class="table table-hover">
    <thead>
      <tr>
      	  <th>Action</th>
	      <th>ID <img height="20" src='{{ sort_icon() }}' onclick="sortTableByNums('table', 0, true)"></th>
	      <th>Fullname <img height="20" src='{{ sort_icon() }}' onclick="sortTable('table', 1)"></th>
	      <th>Card ID <img height="20" src='{{ sort_icon() }}' onclick="sortTableByNums('table', 2, false)"></th>
	      <th>Address <img height="20" src='{{ sort_icon() }}' onclick="sortTable('table', 3)"></th>
	      <th>Email <img height="20" src='{{ sort_icon() }}' onclick="sortTable('table', 4)"></th>
	      <th>Telephone <img height="20" src='{{ sort_icon() }}' onclick="sortTable('table', 5)"></th>
      </tr>
  </thead>
  <tbody>
  	{% for customer in customers %}
	  <tr id="row_{{ loop.index }}" onmouseover='showImages(`{{ loop.index }}`)' onmouseout='hideImages(`{{ loop.index }}`)'>
	  	<th ><img id="del_img_{{ loop.index }}" title="Delete row" height="20" src="{{ url_for('static', filename='images/icons/trash.svg') }}" class="js-open-modal" data-modal="1">     <img id="upd_img_{{ loop.index }}" title="Update row" height="20" src="{{ url_for('static', filename='images/icons/update.svg') }}" class="js-open-modal" data-modal="2"></th>
	      <td scope="row"><strong>{{ customer.0 }}</strong></td>
	      <td>{{ customer.1 }}</td>
	      <td>{{ customer.2 }}</td>
	      <td>{{ customer.3 }}</td>
	      <td>{{ customer.4 }}</td>
	      <td>{{ customer.5 }}</td>
      </tr>
	{% endfor %}
    </tbody>
</table>
<style type="text/css">
	/* Стили для подложки */

.overlay {
   
   /* Скрываем подложку  */
   opacity: 0;
   visibility: hidden;
   
   position: fixed;
   top: 0;
   left: 0;
   width: 100%;
   height: 100%;
   background-color: rgba(0, 0, 0, .5);
   z-index: 20;
   transition: .3s all;
}


/* Стили для модальных окон */

.modalmodal {
   
   /* Скрываем окна  */
   opacity: 0;
   visibility: hidden;
   
   
   /*  Установаем ширину окна  */
   width: 100%;
   max-width: 500px;
   
   /*  Центрируем и задаем z-index */
   position: fixed;
   top: 50%;
   left: 50%;
   transform: translate(-50%, -50%);
   z-index: 30; /* Должен быть выше чем у подложки*/
   
   /*  Побочные стили   */
   box-shadow: 0 3px 10px -.5px rgba(0, 0, 0, .2); 
   padding: 30px;
   border-radius: 3px;
   background-color: #fff;
   transition: 0.3s all;
}


/* Стили для активных классов подложки и окна */

.modalmodal.active,
.overlay.active{
   opacity: 1;
   visibility: visible;
}


/* Стили для кнопки закрытия */

.modal__cross {
   width: 15px;
   height: 15px;
   position: absolute;
   top: 20px;
   right: 20px;
   fill: #444;
   cursor: pointer;
}
</style>

<div class="modalmodal" data-modal="2">
   <!--   Svg иконка для закрытия окна  -->
   <svg class="modal__cross js-modal-close" xmlns="http://www.w3.org/2000/svg"               viewBox="0 0 24 24"><path d="M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"/></svg>
   <h4>Update</h4>
   <hr class="my hr4">
    <form action="/customers/128"  method="post">
        {{ form.hidden_tag() }}
        <p>
            {{ form.fullname.label }}<br>
            {{ form.fullname(size=32) }}<br>
        </p>
        <p>
            {{ form.address.label }}<br>
            {{ form.address(size=32) }}<br>
        </p>
        <p>
            {{ form.email.label }}<br>
            {{ form.email(size=32) }}<br>
        </p>
        <p>
            {{ form.telephone.label }}<br>
            {{ form.telephone(size=16) }}<br>
        </p>
        <p>
            {{ form.card_id.label }}<br>
            {{ form.card_id() }}<br>
        </p>
        <hr class="my hr4">
        <p>
        	<button type="button" class="btn btn-outline-secondary js-modal-close">Cancel</button>
        	{{ form.submit(value="Update", class="btn btn-outline-success") }}
        </p>
    </form>
</div>

<div class="modalmodal" data-modal="1">
   <!--   Svg иконка для закрытия окна  -->
   <svg class="modal__cross js-modal-close" xmlns="http://www.w3.org/2000/svg"               viewBox="0 0 24 24"><path d="M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"/></svg>
   <h4>Delete</h4>
   <hr class="my hr4">
   <p>Are you sure? This action cannot be canceled.
   </p>
   <hr class="my hr4">
   <p style="align-items: right">
	<button type="button" class="btn btn-outline-secondary js-modal-close">Cancel</button>
  <form action="/customers/228" method="post">
    {{ form.submit(value="Delete", class="btn btn-outline-danger") }}
  </form>
   </p>
</div>

<!-- Подложка под модальным окном -->
<div class="overlay js-overlay-modal"></div>

<script type="text/javascript">
!function(e){"function"!=typeof e.matches&&(e.matches=e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||function(e){for(var t=this,o=(t.document||t.ownerDocument).querySelectorAll(e),n=0;o[n]&&o[n]!==t;)++n;return Boolean(o[n])}),"function"!=typeof e.closest&&(e.closest=function(e){for(var t=this;t&&1===t.nodeType;){if(t.matches(e))return t;t=t.parentNode}return null})}(window.Element.prototype);


document.addEventListener('DOMContentLoaded', function() {

   /* Записываем в переменные массив элементов-кнопок и подложку.
      Подложке зададим id, чтобы не влиять на другие элементы с классом overlay*/
   var modalButtons = document.querySelectorAll('.js-open-modal'),
       overlay      = document.querySelector('.js-overlay-modal'),
       closeButtons = document.querySelectorAll('.js-modal-close');


   /* Перебираем массив кнопок */
   modalButtons.forEach(function(item){

      /* Назначаем каждой кнопке обработчик клика */
      item.addEventListener('click', function(e) {

         /* Предотвращаем стандартное действие элемента. Так как кнопку разные
            люди могут сделать по-разному. Кто-то сделает ссылку, кто-то кнопку.
            Нужно подстраховаться. */
         e.preventDefault();

         /* При каждом клике на кнопку мы будем забирать содержимое атрибута data-modal
            и будем искать модальное окно с таким же атрибутом. */
         var modalId = this.getAttribute('data-modal'),
             modalElem = document.querySelector('.modalmodal[data-modal="' + modalId + '"]');


         /* После того как нашли нужное модальное окно, добавим классы
            подложке и окну чтобы показать их. */
         modalElem.classList.add('active');
         overlay.classList.add('active');
      }); // end click

   }); // end foreach


   closeButtons.forEach(function(item){

      item.addEventListener('click', function(e) {
         var parentModal = this.closest('.modalmodal');

         parentModal.classList.remove('active');
         overlay.classList.remove('active');
      });

   }); // end foreach


    document.body.addEventListener('keyup', function (e) {
        var key = e.keyCode;


        if (key == 27) {

            document.querySelector('.modalmodal.active').classList.remove('active');
            document.querySelector('.overlay').classList.remove('active');
        };
    }, false);


    overlay.addEventListener('click', function() {
        document.querySelector('.modalmodal.active').classList.remove('active');
        this.classList.remove('active');
    });




}); // end ready
</script>

{% endblock content %}